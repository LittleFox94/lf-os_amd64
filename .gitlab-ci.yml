image: registry.lf-net.org/littlefox/lf-os_amd64/ci:2020050201
stages:
- test
- build
- pages

variables:
  GIT_SUBMODULE_STRATEGY: recursive
  GIT_STRATEGY:           clone

test:
  stage: test
  script:
    - make test

pages:
  stage: pages
  script:
    - make doc
    - mv doc/doxygen/html public
  artifacts:
    paths:
    - public
  only:
  - master

build:
  stage: build
  script:
    - make hd.img.gz lf-os.iso.gz sysroot.tar.xz
  artifacts:
    paths:
      - hd.img.gz
      - lf-os.iso.gz
      - sysroot.tar.xz
